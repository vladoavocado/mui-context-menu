{"version":3,"file":"mui-context-menu.cjs.production.min.js","sources":["../src/context/index.ts","../src/ui/IconText/index.tsx","../src/ui/MenuItem/index.tsx","../src/ui/Menu/index.tsx","../src/hooks/use-mui-context-menu.ts","../src/providers/index.tsx","../src/hooks/use-click-outside.ts"],"sourcesContent":["import { createContext } from 'react';\nimport { MenuAnchorRef, MenuItemProps, ShrunkMenuProps } from '../types';\n\nexport type MUIContextMenuProps = {\n  setItems(items: MenuItemProps[]): void;\n  setMenuAnchorRef(ref: MenuAnchorRef): void;\n  setMenuProps(props: ShrunkMenuProps): void;\n  menuAnchorEl: HTMLElement | null;\n};\n\nfunction noop() {\n  // eslint-disable-next-line no-console\n  console.info(\n    `Possibly you forgot to wrap your component with MUIContextMenuProvider.`,\n  );\n}\n\nexport const MUIContextMenu = createContext<MUIContextMenuProps>({\n  setItems: noop,\n  setMenuAnchorRef: noop,\n  setMenuProps: noop,\n  menuAnchorEl: null,\n});\n","import * as React from 'react';\nimport { ReactNode } from 'react';\nimport { Stack, Typography, TypographyProps } from '@mui/material';\nimport ChevronRightIcon from '@mui/icons-material/ChevronRight';\n\ntype IconTextProps = {\n  text: ReactNode;\n  startAdornment?: ReactNode;\n  endAdornment?: ReactNode;\n  hasChildren?: boolean;\n  textProps?: TypographyProps;\n};\n\nexport function IconText({\n  text,\n  startAdornment,\n  endAdornment,\n  hasChildren,\n  textProps,\n}: IconTextProps) {\n  if (typeof text !== 'string') {\n    return <>{text}</>;\n  }\n\n  return (\n    <Stack\n      flexDirection='row'\n      gap={2}\n      justifyContent='space-between'\n      sx={{ width: '100%' }}\n    >\n      <Stack gap={1} alignItems='center' flexDirection='row'>\n        {startAdornment}\n        <Typography {...textProps}>{text}</Typography>\n        {endAdornment}\n      </Stack>\n      {hasChildren && <ChevronRightIcon />}\n    </Stack>\n  );\n}\n","import * as React from 'react';\nimport { MouseEventHandler, ReactNode } from 'react';\nimport { alpha } from '@mui/material/styles';\nimport { Box } from '@mui/material';\n\ntype MenuItemProps = {\n  onMouseEnter: MouseEventHandler<HTMLElement>;\n  onMouseLeave: MouseEventHandler<HTMLElement>;\n  isHighlighted?: boolean;\n  isTextComponent?: boolean;\n  highlight?: boolean;\n  children?: ReactNode;\n};\n\nexport function MenuItem({\n  onMouseEnter,\n  onMouseLeave,\n  isHighlighted,\n  isTextComponent,\n  highlight = true,\n  children,\n}: MenuItemProps) {\n  return (\n    <Box\n      sx={({ palette }) => ({\n        px: 2,\n        py: 1,\n        width: '100%',\n        pointerEvents: 'all',\n        backgroundColor:\n          isHighlighted && highlight\n            ? alpha(palette.primary.light, 0.2)\n            : 'transparent',\n\n        '&:hover': {\n          backgroundColor:\n            isTextComponent || highlight\n              ? alpha(palette.primary.light, 0.2)\n              : 'transparent',\n          cursor: 'default',\n        },\n      })}\n      onClick={event => event.preventDefault()}\n      onMouseEnter={onMouseEnter}\n      onMouseLeave={onMouseLeave}\n    >\n      {children}\n    </Box>\n  );\n}\n\n// event => openMenu(id, event)\n","import * as React from 'react';\nimport { useRef, useState, MouseEvent } from 'react';\nimport { Menu as BaseMenu, SxProps } from '@mui/material';\nimport { MenuItemProps, ShrunkMenuProps } from '../../types';\nimport { IconText } from '../IconText';\nimport { MenuItem } from '../MenuItem';\n\ntype MenuProps = {\n  items: MenuItemProps[];\n  parentIndex: string;\n  menuAnchorEl?: HTMLElement | null;\n  menuProps?: ShrunkMenuProps | null;\n  onAddRef?: (ref: HTMLElement) => void;\n  onClose?: () => void;\n  sx?: SxProps;\n};\n\nexport function Menu({\n  items,\n  onClose,\n  onAddRef,\n  menuProps,\n  menuAnchorEl,\n  parentIndex,\n  sx,\n}: MenuProps) {\n  const [openSubmenus, setOpenSubmenus] = useState<\n    Record<string, HTMLElement | null>\n  >({});\n\n  const anchorTimeouts = useRef<Record<string, NodeJS.Timeout | null>>({});\n\n  const closeMenu = (id: string) => {\n    anchorTimeouts.current[id] = setTimeout(() => {\n      setOpenSubmenus(prevState => ({\n        ...prevState,\n        [id]: null,\n      }));\n\n      anchorTimeouts.current[id] = null;\n    }, 600);\n  };\n\n  const openMenu = (id: string, event: MouseEvent<HTMLElement>) => {\n    if (anchorTimeouts.current[id]) {\n      clearTimeout(anchorTimeouts.current[id]!);\n      anchorTimeouts.current[id] = null;\n    }\n\n    setOpenSubmenus({\n      [id]: event!.currentTarget,\n    });\n  };\n\n  return (\n    <BaseMenu\n      ref={ref => {\n        if (ref) {\n          onAddRef?.(ref);\n        }\n      }}\n      open={Boolean(menuAnchorEl)}\n      anchorEl={menuAnchorEl}\n      anchorOrigin={\n        menuProps?.anchorOrigin ?? {\n          vertical: 'top',\n          horizontal: 'left',\n        }\n      }\n      transformOrigin={\n        menuProps?.transformOrigin ?? {\n          vertical: 'top',\n          horizontal: 'right',\n        }\n      }\n      sx={{\n        padding: '1em',\n        pointerEvents: 'none',\n\n        '& .MuiList-root': {\n          p: 0,\n        },\n        ...sx,\n      }}\n      disableAutoFocus\n      disableEnforceFocus\n      onMouseLeave={() => {\n        if (!openSubmenus[parentIndex]) {\n          onClose?.();\n        }\n      }}\n    >\n      {items.map(\n        (\n          {\n            text,\n            children,\n            textProps,\n            highlight,\n            startAdornment,\n            endAdornment,\n          },\n          index,\n        ) => {\n          const id = `${parentIndex}-${index}`;\n\n          return (\n            <MenuItem\n              key={id}\n              highlight={highlight}\n              isHighlighted={Boolean(openSubmenus[id] && items.length > 1)}\n              isTextComponent={typeof text === 'string'}\n              onMouseEnter={event => openMenu(id, event)}\n              onMouseLeave={() => {\n                if (openSubmenus[id] && children) {\n                  closeMenu(id);\n                }\n              }}\n            >\n              <IconText\n                text={text}\n                hasChildren={(children?.length ?? 0) >= 1}\n                textProps={textProps}\n                startAdornment={startAdornment}\n                endAdornment={endAdornment}\n              />\n              {children && (\n                <Menu\n                  items={children}\n                  menuAnchorEl={openSubmenus[id]}\n                  parentIndex={id}\n                  onAddRef={onAddRef}\n                  sx={{\n                    pointerEvents: 'none',\n\n                    '& .MuiMenuItem-root': {\n                      pointerEvents: 'auto',\n                    },\n                  }}\n                />\n              )}\n            </MenuItem>\n          );\n        },\n      )}\n    </BaseMenu>\n  );\n}\n","import { useContext, useEffect } from 'react';\nimport { MUIContextMenu } from '../context';\nimport { MenuAnchorRef, MenuItemProps, ShrunkMenuProps } from '../types';\n\nexport type MUIContextMenuHookProps = {\n  items: MenuItemProps[];\n  anchorRef: MenuAnchorRef;\n  menuProps?: ShrunkMenuProps;\n};\n\nexport const useMUIContextMenu = ({\n  items,\n  anchorRef,\n  menuProps,\n}: MUIContextMenuHookProps) => {\n  const { setItems, setMenuAnchorRef, setMenuProps } =\n    useContext(MUIContextMenu);\n\n  useEffect(() => {\n    setItems(items);\n  }, [items]);\n\n  useEffect(() => {\n    if (menuProps) {\n      setMenuProps(menuProps);\n    }\n  }, [menuProps]);\n\n  return {\n    show() {\n      setMenuAnchorRef(anchorRef);\n    },\n    hide() {\n      setMenuAnchorRef(null);\n    },\n  };\n};\n","import * as React from 'react';\nimport { useMemo, useRef, useState } from 'react';\nimport { MUIContextMenu } from '../context';\nimport { Menu } from '../ui/Menu';\nimport { MenuItemProps, ShrunkMenuProps } from '../types';\nimport { useClickOutside } from '../hooks';\n\ntype MUIContextMenuProviderProps = {};\n\nexport const withMUIContextMenuProvider = (\n  Component: (props: any) => JSX.Element | null,\n) =>\n  function MUIContextMenuProvider(props: MUIContextMenuProviderProps) {\n    const [items, setItems] = useState<MenuItemProps[]>([]);\n    const [menuAnchorEl, setMenuAnchorRef] = useState<HTMLElement | null>(null);\n    const [menuProps, setMenuProps] = useState<ShrunkMenuProps | null>(null);\n    const submenuRefs = useRef<HTMLElement[]>([]);\n\n    const contextApi = useMemo(\n      () => ({\n        setItems,\n        setMenuAnchorRef,\n        setMenuProps,\n        menuAnchorEl,\n      }),\n      [],\n    );\n\n    useClickOutside(submenuRefs?.current, () => setMenuAnchorRef(null));\n\n    return (\n      <MUIContextMenu.Provider value={contextApi}>\n        <Component {...props} />\n        <Menu\n          items={items}\n          parentIndex='0'\n          menuAnchorEl={menuAnchorEl}\n          menuProps={menuProps}\n          onClose={() => setMenuAnchorRef(null)}\n          onAddRef={(ref: HTMLElement) => {\n            if (!submenuRefs.current.includes(ref)) {\n              submenuRefs.current.push(ref);\n            }\n          }}\n        />\n      </MUIContextMenu.Provider>\n    );\n  };\n","import { useEffect } from 'react';\n\nexport const useClickOutside = (\n  anchors: HTMLElement[],\n  onClose: () => void,\n) => {\n  useEffect(() => {\n    function handleClickOutside(event: MouseEvent | Event) {\n      if (!anchors) {\n        return;\n      }\n\n      const isClickInside = anchors.some(ref =>\n        ref?.contains(event.target as Node),\n      );\n\n      if (!isClickInside) {\n        onClose?.();\n      }\n    }\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [anchors, onClose]);\n};\n"],"names":["noop","console","info","MUIContextMenu","createContext","setItems","setMenuAnchorRef","setMenuProps","menuAnchorEl","IconText","_ref","text","startAdornment","endAdornment","hasChildren","textProps","React","Stack","flexDirection","gap","justifyContent","sx","width","alignItems","Typography","ChevronRightIcon","MenuItem","isHighlighted","isTextComponent","_ref$highlight","highlight","Box","_ref2","palette","px","py","pointerEvents","backgroundColor","alpha","primary","light","&:hover","cursor","onClick","event","preventDefault","onMouseEnter","onMouseLeave","children","Menu","items","onClose","onAddRef","menuProps","parentIndex","_useState","useState","openSubmenus","setOpenSubmenus","anchorTimeouts","useRef","BaseMenu","ref","open","Boolean","anchorEl","anchorOrigin","_menuProps$anchorOrig","vertical","horizontal","transformOrigin","_menuProps$transformO","_extends","padding","& .MuiList-root","p","disableAutoFocus","disableEnforceFocus","map","_ref3","index","id","key","length","current","clearTimeout","_setOpenSubmenus","currentTarget","openMenu","setTimeout","prevState","_extends2","closeMenu","_children$length","& .MuiMenuItem-root","anchorRef","_useContext","useContext","useEffect","show","hide","Component","props","anchors","_useState2","_useState3","submenuRefs","contextApi","useMemo","handleClickOutside","some","contains","target","document","addEventListener","removeEventListener","Provider","value","includes","push"],"mappings":"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"}